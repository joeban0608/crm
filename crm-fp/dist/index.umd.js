(function(t,e){typeof exports=="object"&&typeof module<"u"?e(exports):typeof define=="function"&&define.amd?define(["exports"],e):(t=typeof globalThis<"u"?globalThis:t||self,e(t.CRMFingerprint={}))})(this,function(t){"use strict";var X=Object.defineProperty;var H=t=>{throw TypeError(t)};var Y=(t,e,u)=>e in t?X(t,e,{enumerable:!0,configurable:!0,writable:!0,value:u}):t[e]=u;var A=(t,e,u)=>Y(t,typeof e!="symbol"?e+"":e,u),J=(t,e,u)=>e.has(t)||H("Cannot "+u);var i=(t,e,u)=>(J(t,e,"read from private field"),u?u.call(t):e.get(t)),y=(t,e,u)=>e.has(t)?H("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,u),x=(t,e,u,E)=>(J(t,e,"write to private field"),E?E.call(t,u):e.set(t,u),u),M=(t,e,u)=>(J(t,e,"access private method"),u);var m,O,R,C,$,k,f,F,v,L;function e(h){function n(o,c){return o>>>c|o<<32-c}const p=new TextEncoder().encode(h),l=Array.from(p),g=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],r=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],S=l.length*8;for(l.push(128);(l.length*8+64)%512!==0;)l.push(0);const b=new Array(8).fill(0);for(let o=0;o<8;o++)b[7-o]=S>>>o*8&255;l.push(...b);const T=[];for(let o=0;o<l.length;o+=64)T.push(l.slice(o,o+64));return T.forEach(o=>{const c=new Array(64);for(let s=0;s<16;s++)c[s]=o[s*4]<<24|o[s*4+1]<<16|o[s*4+2]<<8|o[s*4+3];for(let s=16;s<64;s++){const U=n(c[s-15],7)^n(c[s-15],18)^c[s-15]>>>3,I=n(c[s-2],17)^n(c[s-2],19)^c[s-2]>>>10;c[s]=c[s-16]+U+c[s-7]+I|0}let[d,a,D,N,w,j,B,P]=r;for(let s=0;s<64;s++){const U=n(w,6)^n(w,11)^n(w,25),I=w&j^~w&B,V=P+U+I+g[s]+c[s]|0,z=n(d,2)^n(d,13)^n(d,22),Q=d&a^d&D^a&D,W=z+Q|0;P=B,B=j,j=w,w=N+V|0,N=D,D=a,a=d,d=V+W|0}r[0]=r[0]+d|0,r[1]=r[1]+a|0,r[2]=r[2]+D|0,r[3]=r[3]+N|0,r[4]=r[4]+w|0,r[5]=r[5]+j|0,r[6]=r[6]+B|0,r[7]=r[7]+P|0}),r.map(o=>(o>>>0).toString(16).padStart(8,"0")).join("")}class u{constructor(){y(this,C);A(this,"name","Audio Feature");A(this,"enabled",!0);y(this,m,null);y(this,O,null);y(this,R,5e3)}async support(){const n=window.OfflineAudioContext||window.webkitOfflineAudioContext;return n?(x(this,m,new n(1,i(this,R),44100)),i(this,m)!==null):!1}async data(){if(i(this,m)===null)return null;const n=await M(this,C,$).call(this,i(this,m));return n===null?null:(x(this,O,await e(n.toString())),{fingerprint:i(this,O),info:{audio:n}})}}m=new WeakMap,O=new WeakMap,R=new WeakMap,C=new WeakSet,$=function(n){return new Promise(p=>{const l=n.createOscillator();l.type="triangle",l.frequency.value=1e4;const g=n.createDynamicsCompressor();g.threshold.value=-50,g.knee.value=40,g.ratio.value=12,g.attack.value=0,g.release.value=.2,l.connect(g),g.connect(n.destination),l.start(),n.oncomplete=r=>{const S=r.renderedBuffer.getChannelData(0),b=M(this,C,k).call(this,S);p(b)},n.startRendering()})},k=function(n){let p=0;for(let l=0;l<n.length;++l)p+=Math.abs(n[l]);return p};class E{constructor(){A(this,"name","Canvas Feature");A(this,"enabled",!0);y(this,f,null);y(this,F,null)}async support(){return document?(x(this,f,document.createElement("canvas").getContext("2d")),i(this,f)!==null):!1}async data(){return i(this,f)===null?null:(i(this,f).textBaseline="top",i(this,f).font="14px 'Arial'",i(this,f).textBaseline="alphabetic",i(this,f).fillStyle="#f60",i(this,f).fillRect(100,1,55,20),i(this,f).fillStyle="#069",i(this,f).fillText("Cyber Universe Canvas",2,15),i(this,f).fillStyle="rgba(102, 204, 0, 0.7)",i(this,f).fillText("Cyber Universe Canvas",4,17),x(this,F,i(this,f).canvas.toDataURL()),{fingerprint:await e(i(this,F)),info:{image:i(this,F)}})}}f=new WeakMap,F=new WeakMap;class q{constructor(){A(this,"name","Languages Feature");A(this,"enabled",!0);y(this,v,[]);y(this,L,null)}async support(){return!!navigator}async data(){return navigator.language&&i(this,v).push([navigator.language]),Array.isArray(navigator.languages)&&i(this,v).push(navigator.languages),x(this,L,JSON.stringify(i(this,v))),{fingerprint:await e(i(this,L)),info:{languages:i(this,v)}}}}v=new WeakMap,L=new WeakMap;const G=async h=>h.enabled?await h.support()?await h.data():(console.log(`Feature ${h.name} is not supported`),null):(console.log(`Feature ${h.name} is disabled`),null),K=async()=>await _(),_=async()=>{var r,S,b,T,o,c;const h=[new E,new u,new q];let n="",p="",l="";const g=[];console.log("features",h);for(const d of h){const a=await G(d);(r=a==null?void 0:a.info)!=null&&r.image&&(n=(S=a==null?void 0:a.info)==null?void 0:S.image),(b=a==null?void 0:a.info)!=null&&b.audio&&(p=(T=a==null?void 0:a.info)==null?void 0:T.audio),(o=a==null?void 0:a.info)!=null&&o.languages&&(l=JSON.stringify((c=a==null?void 0:a.info)==null?void 0:c.languages)),g.push((a==null?void 0:a.fingerprint)||"")}return{id:await e(JSON.stringify(g)),useragent:navigator.userAgent,rawData:{canvas:{hash:await e(n),value:n},audio:{hash:await e(p),value:p},languages:{hash:await e(l),value:l}}}};t.fpPromise=K,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});
