(function(a,n){typeof exports=="object"&&typeof module<"u"?n(exports):typeof define=="function"&&define.amd?define(["exports"],n):(a=typeof globalThis<"u"?globalThis:a||self,n(a.CRMFingerprint={}))})(this,function(a){"use strict";var wt=Object.defineProperty;var at=a=>{throw TypeError(a)};var yt=(a,n,c)=>n in a?wt(a,n,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[n]=c;var f=(a,n,c)=>yt(a,typeof n!="symbol"?n+"":n,c),tt=(a,n,c)=>n.has(a)||at("Cannot "+c);var e=(a,n,c)=>(tt(a,n,"read from private field"),c?c.call(a):n.get(a)),l=(a,n,c)=>n.has(a)?at("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(a):n.set(a,c),g=(a,n,c,j)=>(tt(a,n,"write to private field"),j?j.call(a,c):n.set(a,c),c),Q=(a,n,c)=>(tt(a,n,"access private method"),c);var F,L,k,S,rt,it,p,A,T,R,O,z,M,$,V,x,D,y,E,b,G,st;function n(d){function t(h,m){return h>>>m|h<<32-m}const r=new TextEncoder().encode(d),o=Array.from(r),i=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],u=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],Z=o.length*8;for(o.push(128);(o.length*8+64)%512!==0;)o.push(0);const H=new Array(8).fill(0);for(let h=0;h<8;h++)H[7-h]=Z>>>h*8&255;o.push(...H);const et=[];for(let h=0;h<o.length;h+=64)et.push(o.slice(h,h+64));return et.forEach(h=>{const m=new Array(64);for(let s=0;s<16;s++)m[s]=h[s*4]<<24|h[s*4+1]<<16|h[s*4+2]<<8|h[s*4+3];for(let s=16;s<64;s++){const Y=t(m[s-15],7)^t(m[s-15],18)^m[s-15]>>>3,_=t(m[s-2],17)^t(m[s-2],19)^m[s-2]>>>10;m[s]=m[s-16]+Y+m[s-7]+_|0}let[v,I,U,W,C,J,N,X]=u;for(let s=0;s<64;s++){const Y=t(C,6)^t(C,11)^t(C,25),_=C&J^~C&N,nt=X+Y+_+i[s]+m[s]|0,gt=t(v,2)^t(v,13)^t(v,22),pt=v&I^v&U^I&U,mt=gt+pt|0;X=N,N=J,J=C,C=W+nt|0,W=U,U=I,I=v,v=nt+mt|0}u[0]=u[0]+v|0,u[1]=u[1]+I|0,u[2]=u[2]+U|0,u[3]=u[3]+W|0,u[4]=u[4]+C|0,u[5]=u[5]+J|0,u[6]=u[6]+N|0,u[7]=u[7]+X|0}),u.map(h=>(h>>>0).toString(16).padStart(8,"0")).join("")}class c{constructor(){l(this,S);f(this,"name","Audio Feature");f(this,"enabled",!0);l(this,F,null);l(this,L,null);l(this,k,5e3)}async support(){const t=window.OfflineAudioContext||window.webkitOfflineAudioContext;return t?(g(this,F,new t(1,e(this,k),44100)),e(this,F)!==null):!1}async data(){if(e(this,F)===null)return null;const t=await Q(this,S,rt).call(this,e(this,F));return t===null?null:(g(this,L,t.toString()),{fingerprint:await n(e(this,L)),info:{audio:t}})}}F=new WeakMap,L=new WeakMap,k=new WeakMap,S=new WeakSet,rt=function(t){return new Promise(r=>{const o=t.createOscillator();o.type="triangle",o.frequency.value=1e4;const i=t.createDynamicsCompressor();i.threshold.value=-50,i.knee.value=40,i.ratio.value=12,i.attack.value=0,i.release.value=.2,o.connect(i),i.connect(t.destination),o.start(),t.oncomplete=u=>{const Z=u.renderedBuffer.getChannelData(0),H=Q(this,S,it).call(this,Z);r(H)},t.startRendering()})},it=function(t){let r=0;for(let o=0;o<t.length;++o)r+=Math.abs(t[o]);return r};class j{constructor(){f(this,"name","Canvas Feature");f(this,"enabled",!0);l(this,p,null);l(this,A,null)}async support(){return document?(g(this,p,document.createElement("canvas").getContext("2d")),e(this,p)!==null):!1}async data(){return e(this,p)===null?null:(e(this,p).textBaseline="top",e(this,p).font="14px 'Arial'",e(this,p).textBaseline="alphabetic",e(this,p).fillStyle="#f60",e(this,p).fillRect(100,1,55,20),e(this,p).fillStyle="#069",e(this,p).fillText("Cyber Universe Canvas",2,15),e(this,p).fillStyle="rgba(102, 204, 0, 0.7)",e(this,p).fillText("Cyber Universe Canvas",4,17),g(this,A,e(this,p).canvas.toDataURL()),{fingerprint:await n(e(this,A)),info:{image:e(this,A)}})}}p=new WeakMap,A=new WeakMap;const B=class B{constructor(){f(this,"name","ColorGamut Feature");f(this,"enabled",!0);l(this,T,null);l(this,R,null)}async support(){return!0}async data(){for(const t of B.gamutList){const r=`(color-gamut: ${t})`;if(matchMedia(r).matches){g(this,T,`gamut: ${t}`),g(this,R,t);break}}return e(this,T)===null?null:{fingerprint:await n(e(this,T)),info:{colorGamut:e(this,R)}}}};T=new WeakMap,R=new WeakMap,f(B,"gamutList",["rec2020","p3","srgb"]);let q=B;class ot{constructor(){f(this,"name","Hardware Concurrency Feature");f(this,"enabled",!0);l(this,O,null);l(this,z,null);l(this,M,null)}async support(){return!!navigator}async data(){return navigator.hardwareConcurrency&&(g(this,O,navigator.hardwareConcurrency.toString()),g(this,M,navigator.hardwareConcurrency)),e(this,O)?(g(this,z,"hardware concurrency: "+e(this,O)),{fingerprint:await n(e(this,z)),info:{hardwareConcurrency:e(this,M)}}):null}}O=new WeakMap,z=new WeakMap,M=new WeakMap;const P=class P{constructor(){f(this,"name","HDR Feature");f(this,"enabled",!0);l(this,$,null);l(this,V,null)}async support(){return!0}async data(){for(const t of P.hdrList){const r=`(dynamic-range: ${t})`;if(matchMedia(r).matches){g(this,$,`dynamic-range: ${t}`),g(this,V,t);break}}return e(this,$)===null?null:{fingerprint:await n(e(this,$)),info:{hdr:e(this,V)}}}};$=new WeakMap,V=new WeakMap,f(P,"hdrList",["high","standard"]);let K=P;class ut{constructor(){f(this,"name","Languages Feature");f(this,"enabled",!0);l(this,x,[]);l(this,D,null)}async support(){return!!navigator}async data(){var t;return navigator.language&&e(this,x).push([navigator.language]),Array.isArray(navigator.languages)&&e(this,x).push(navigator.languages),(t=e(this,x))!=null&&t.length?(g(this,D,JSON.stringify(e(this,x))),{fingerprint:await n(e(this,D)),info:{languages:e(this,D)}}):null}}x=new WeakMap,D=new WeakMap;class lt{constructor(){f(this,"name","Screen resolution Feature");f(this,"enabled",!0);l(this,y,null);l(this,E,null)}async support(){if(!(window.OfflineAudioContext||window.webkitOfflineAudioContext))return!1;const r=window.screen;return r?(g(this,y,r),e(this,y)!==null):!1}async data(){if(e(this,y)===null)return null;const t=`${e(this,y).width} x ${e(this,y).height}`;return g(this,E,t),{fingerprint:await n(e(this,E)),info:{screenResolution:t}}}}y=new WeakMap,E=new WeakMap;class ct{constructor(){l(this,G);f(this,"name","Timezone Feature");f(this,"enabled",!0);l(this,b,null)}async support(){return!0}async data(){if(Intl.DateTimeFormat){const t=new Intl.DateTimeFormat().resolvedOptions().timeZone;g(this,b,t)}else g(this,b,Q(this,G,st).call(this));return e(this,b)===null?null:{fingerprint:await n(e(this,b)),info:{timezone:e(this,b)}}}}b=new WeakMap,G=new WeakSet,st=function(){const r=-new Date().getTimezoneOffset(),o=r>=0?"+":"-",i=Math.floor(Math.abs(r)/60).toString().padStart(2,"0"),u=(Math.abs(r)%60).toString().padStart(2,"0");return`UTC${o}${i}:${u}`};const ht=async d=>d.enabled?await d.support()?await d.data():(console.log(`Feature ${d.name} is not supported`),null):(console.log(`Feature ${d.name} is disabled`),null),ft=async()=>await dt(),dt=async()=>{const d=[new c,new j,new q,new K,new ot,new ut,new lt,new ct],t=[],r={};for(const o of d){const i=await ht(o);w(r,i,"audio","audio"),w(r,i,"canvas","image"),w(r,i,"color gamut","colorGamut"),w(r,i,"hdr","hdr"),w(r,i,"hardware concurrency","hardwareConcurrency"),w(r,i,"languages","languages"),w(r,i,"screen resolution","screenResolution"),w(r,i,"timezone","timezone"),t.push((i==null?void 0:i.fingerprint)||"")}return{id:await n(JSON.stringify(t)),useragent:navigator.userAgent,rawData:r}},w=(d,t,r,o)=>{var i;(i=t==null?void 0:t.info)!=null&&i[o]&&(d[r]={hash:t.fingerprint,value:t.info[o]})};a.fpPromise=ft,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});
