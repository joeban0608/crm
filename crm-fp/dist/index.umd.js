(function(a,n){typeof exports=="object"&&typeof module<"u"?n(exports):typeof define=="function"&&define.amd?define(["exports"],n):(a=typeof globalThis<"u"?globalThis:a||self,n(a.CRMFingerprint={}))})(this,function(a){"use strict";var gt=Object.defineProperty;var et=a=>{throw TypeError(a)};var pt=(a,n,u)=>n in a?gt(a,n,{enumerable:!0,configurable:!0,writable:!0,value:u}):a[n]=u;var d=(a,n,u)=>pt(a,typeof n!="symbol"?n+"":n,u),Y=(a,n,u)=>n.has(a)||et("Cannot "+u);var e=(a,n,u)=>(Y(a,n,"read from private field"),u?u.call(a):n.get(a)),h=(a,n,u)=>n.has(a)?et("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(a):n.set(a,u),p=(a,n,u,I)=>(Y(a,n,"write to private field"),I?I.call(a,u):n.set(a,u),u),J=(a,n,u)=>(Y(a,n,"access private method"),u);var C,D,U,S,nt,at,g,A,x,$,T,z,M,L,R,F,O,y,P,rt;function n(f){function t(c,m){return c>>>m|c<<32-m}const r=new TextEncoder().encode(f),o=Array.from(r),i=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],l=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],q=o.length*8;for(o.push(128);(o.length*8+64)%512!==0;)o.push(0);const k=new Array(8).fill(0);for(let c=0;c<8;c++)k[7-c]=q>>>c*8&255;o.push(...k);const _=[];for(let c=0;c<o.length;c+=64)_.push(o.slice(c,c+64));return _.forEach(c=>{const m=new Array(64);for(let s=0;s<16;s++)m[s]=c[s*4]<<24|c[s*4+1]<<16|c[s*4+2]<<8|c[s*4+3];for(let s=16;s<64;s++){const W=t(m[s-15],7)^t(m[s-15],18)^m[s-15]>>>3,X=t(m[s-2],17)^t(m[s-2],19)^m[s-2]>>>10;m[s]=m[s-16]+W+m[s-7]+X|0}let[w,V,E,K,v,H,G,Z]=l;for(let s=0;s<64;s++){const W=t(v,6)^t(v,11)^t(v,25),X=v&H^~v&G,tt=Z+W+X+i[s]+m[s]|0,ht=t(w,2)^t(w,13)^t(w,22),ft=w&V^w&E^V&E,dt=ht+ft|0;Z=G,G=H,H=v,v=K+tt|0,K=E,E=V,V=w,w=tt+dt|0}l[0]=l[0]+w|0,l[1]=l[1]+V|0,l[2]=l[2]+E|0,l[3]=l[3]+K|0,l[4]=l[4]+v|0,l[5]=l[5]+H|0,l[6]=l[6]+G|0,l[7]=l[7]+Z|0}),l.map(c=>(c>>>0).toString(16).padStart(8,"0")).join("")}class u{constructor(){h(this,S);d(this,"name","Audio Feature");d(this,"enabled",!0);h(this,C,null);h(this,D,null);h(this,U,5e3)}async support(){const t=window.OfflineAudioContext||window.webkitOfflineAudioContext;return t?(p(this,C,new t(1,e(this,U),44100)),e(this,C)!==null):!1}async data(){if(e(this,C)===null)return null;const t=await J(this,S,nt).call(this,e(this,C));return t===null?null:(p(this,D,t.toString()),{fingerprint:await n(e(this,D)),info:{audio:t}})}}C=new WeakMap,D=new WeakMap,U=new WeakMap,S=new WeakSet,nt=function(t){return new Promise(r=>{const o=t.createOscillator();o.type="triangle",o.frequency.value=1e4;const i=t.createDynamicsCompressor();i.threshold.value=-50,i.knee.value=40,i.ratio.value=12,i.attack.value=0,i.release.value=.2,o.connect(i),i.connect(t.destination),o.start(),t.oncomplete=l=>{const q=l.renderedBuffer.getChannelData(0),k=J(this,S,at).call(this,q);r(k)},t.startRendering()})},at=function(t){let r=0;for(let o=0;o<t.length;++o)r+=Math.abs(t[o]);return r};class I{constructor(){d(this,"name","Canvas Feature");d(this,"enabled",!0);h(this,g,null);h(this,A,null)}async support(){return document?(p(this,g,document.createElement("canvas").getContext("2d")),e(this,g)!==null):!1}async data(){return e(this,g)===null?null:(e(this,g).textBaseline="top",e(this,g).font="14px 'Arial'",e(this,g).textBaseline="alphabetic",e(this,g).fillStyle="#f60",e(this,g).fillRect(100,1,55,20),e(this,g).fillStyle="#069",e(this,g).fillText("Cyber Universe Canvas",2,15),e(this,g).fillStyle="rgba(102, 204, 0, 0.7)",e(this,g).fillText("Cyber Universe Canvas",4,17),p(this,A,e(this,g).canvas.toDataURL()),{fingerprint:await n(e(this,A)),info:{image:e(this,A)}})}}g=new WeakMap,A=new WeakMap;const j=class j{constructor(){d(this,"name","ColorGamut Feature");d(this,"enabled",!0);h(this,x,null);h(this,$,null)}async support(){return!0}async data(){for(const t of j.gamutList){const r=`(color-gamut: ${t})`;if(matchMedia(r).matches){p(this,x,`gamut: ${t}`),p(this,$,t);break}}return e(this,x)===null?null:{fingerprint:await n(e(this,x)),info:{colorGamut:e(this,$)}}}};x=new WeakMap,$=new WeakMap,d(j,"gamutList",["rec2020","p3","srgb"]);let N=j;class it{constructor(){d(this,"name","Hardware Concurrency Feature");d(this,"enabled",!0);h(this,T,null);h(this,z,null);h(this,M,null)}async support(){return!!navigator}async data(){return navigator.hardwareConcurrency&&(p(this,T,navigator.hardwareConcurrency.toString()),p(this,M,navigator.hardwareConcurrency)),e(this,T)?(p(this,z,"hardware concurrency: "+e(this,T)),{fingerprint:await n(e(this,z)),info:{hardwareConcurrency:e(this,M)}}):null}}T=new WeakMap,z=new WeakMap,M=new WeakMap;const B=class B{constructor(){d(this,"name","HDR Feature");d(this,"enabled",!0);h(this,L,null);h(this,R,null)}async support(){return!0}async data(){for(const t of B.hdrList){const r=`(dynamic-range: ${t})`;if(matchMedia(r).matches){p(this,L,`dynamic-range: ${t}`),p(this,R,t);break}}return e(this,L)===null?null:{fingerprint:await n(e(this,L)),info:{hdr:e(this,R)}}}};L=new WeakMap,R=new WeakMap,d(B,"hdrList",["high","standard"]);let Q=B;class st{constructor(){d(this,"name","Languages Feature");d(this,"enabled",!0);h(this,F,[]);h(this,O,null)}async support(){return!!navigator}async data(){var t;return navigator.language&&e(this,F).push([navigator.language]),Array.isArray(navigator.languages)&&e(this,F).push(navigator.languages),(t=e(this,F))!=null&&t.length?(p(this,O,JSON.stringify(e(this,F))),{fingerprint:await n(e(this,O)),info:{languages:e(this,O)}}):null}}F=new WeakMap,O=new WeakMap;class ot{constructor(){h(this,P);d(this,"name","Timezone Feature");d(this,"enabled",!0);h(this,y,null)}async support(){return!0}async data(){if(Intl.DateTimeFormat){const t=new Intl.DateTimeFormat().resolvedOptions().timeZone;p(this,y,t)}else p(this,y,J(this,P,rt).call(this));return e(this,y)===null?null:{fingerprint:await n(e(this,y)),info:{timezone:e(this,y)}}}}y=new WeakMap,P=new WeakSet,rt=function(){const r=-new Date().getTimezoneOffset(),o=r>=0?"+":"-",i=Math.floor(Math.abs(r)/60).toString().padStart(2,"0"),l=(Math.abs(r)%60).toString().padStart(2,"0");return`UTC${o}${i}:${l}`};const lt=async f=>f.enabled?await f.support()?await f.data():(console.log(`Feature ${f.name} is not supported`),null):(console.log(`Feature ${f.name} is disabled`),null),ut=async()=>await ct(),ct=async()=>{const f=[new u,new I,new N,new Q,new it,new st,new ot],t=[],r={};for(const o of f){const i=await lt(o);b(r,i,"audio","audio"),b(r,i,"canvas","image"),b(r,i,"color gamut","colorGamut"),b(r,i,"hdr","hdr"),b(r,i,"hardware concurrency","hardwareConcurrency"),b(r,i,"languages","languages"),b(r,i,"timezone","timezone"),t.push((i==null?void 0:i.fingerprint)||"")}return{id:await n(JSON.stringify(t)),useragent:navigator.userAgent,rawData:r}},b=(f,t,r,o)=>{var i;(i=t==null?void 0:t.info)!=null&&i[o]&&(f[r]={hash:t.fingerprint,value:t.info[o]})};a.fpPromise=ut,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});
