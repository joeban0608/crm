(function(s,r){typeof exports=="object"&&typeof module<"u"?r(exports):typeof define=="function"&&define.amd?define(["exports"],r):(s=typeof globalThis<"u"?globalThis:s||self,r(s.CRMFingerprint={}))})(this,function(s){"use strict";var we=Object.defineProperty;var q=s=>{throw TypeError(s)};var be=(s,r,d)=>r in s?we(s,r,{enumerable:!0,configurable:!0,writable:!0,value:d}):s[r]=d;var A=(s,r,d)=>be(s,typeof r!="symbol"?r+"":r,d),U=(s,r,d)=>r.has(s)||q("Cannot "+d);var g=(s,r,d)=>(U(s,r,"read from private field"),d?d.call(s):r.get(s)),E=(s,r,d)=>r.has(s)?q("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(s):r.set(s,d),T=(s,r,d,P)=>(U(s,r,"write to private field"),P?P.call(s,d):r.set(s,d),d),$=(s,r,d)=>(U(s,r,"access private method"),d);var x,N,R,v,Z,Q,p,_,O;function r(t){function e(u,i){return u>>>i|u<<32-i}const a=new TextEncoder().encode(t),o=Array.from(a),h=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],c=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],w=o.length*8;for(o.push(128);(o.length*8+64)%512!==0;)o.push(0);const m=new Array(8).fill(0);for(let u=0;u<8;u++)m[7-u]=w>>>u*8&255;o.push(...m);const S=[];for(let u=0;u<o.length;u+=64)S.push(o.slice(u,u+64));return S.forEach(u=>{const i=new Array(64);for(let l=0;l<16;l++)i[l]=u[l*4]<<24|u[l*4+1]<<16|u[l*4+2]<<8|u[l*4+3];for(let l=16;l<64;l++){const D=e(i[l-15],7)^e(i[l-15],18)^i[l-15]>>>3,I=e(i[l-2],17)^e(i[l-2],19)^i[l-2]>>>10;i[l]=i[l-16]+D+i[l-7]+I|0}let[f,b,y,C,n,F,G,M]=c;for(let l=0;l<64;l++){const D=e(n,6)^e(n,11)^e(n,25),I=n&F^~n&G,X=M+D+I+h[l]+i[l]|0,he=e(f,2)^e(f,13)^e(f,22),pe=f&b^f&y^b&y,me=he+pe|0;M=G,G=F,F=n,n=C+X|0,C=y,y=b,b=f,f=X+me|0}c[0]=c[0]+f|0,c[1]=c[1]+b|0,c[2]=c[2]+y|0,c[3]=c[3]+C|0,c[4]=c[4]+n|0,c[5]=c[5]+F|0,c[6]=c[6]+G|0,c[7]=c[7]+M|0}),c.map(u=>(u>>>0).toString(16).padStart(8,"0")).join("")}class d{constructor(){E(this,v);A(this,"name","Audio Feature");A(this,"enabled",!0);E(this,x,null);E(this,N,null);E(this,R,5e3)}async support(){const e=window.OfflineAudioContext||window.webkitOfflineAudioContext;return e?(T(this,x,new e(1,g(this,R),44100)),g(this,x)!==null):!1}async data(){if(g(this,x)===null)return null;const e=await $(this,v,Z).call(this,g(this,x));return e===null?null:(T(this,N,await r(e.toString())),{fingerprint:g(this,N),info:{audio:e}})}}x=new WeakMap,N=new WeakMap,R=new WeakMap,v=new WeakSet,Z=function(e){return new Promise(a=>{const o=e.createOscillator();o.type="triangle",o.frequency.value=1e4;const h=e.createDynamicsCompressor();h.threshold.value=-50,h.knee.value=40,h.ratio.value=12,h.attack.value=0,h.release.value=.2,o.connect(h),h.connect(e.destination),o.start(),e.oncomplete=c=>{const w=c.renderedBuffer.getChannelData(0),m=$(this,v,Q).call(this,w);a(m)},e.startRendering()})},Q=function(e){let a=0;for(let o=0;o<e.length;++o)a+=Math.abs(e[o]);return a};class P{constructor(){A(this,"name","Canvas Feature");A(this,"enabled",!0);E(this,p,null);E(this,_,null)}async support(){return document?(T(this,p,document.createElement("canvas").getContext("2d")),g(this,p)!==null):!1}async data(){return g(this,p)===null?null:(g(this,p).textBaseline="top",g(this,p).font="14px 'Arial'",g(this,p).textBaseline="alphabetic",g(this,p).fillStyle="#f60",g(this,p).fillRect(100,1,55,20),g(this,p).fillStyle="#069",g(this,p).fillText("Cyber Universe Canvas",2,15),g(this,p).fillStyle="rgba(102, 204, 0, 0.7)",g(this,p).fillText("Cyber Universe Canvas",4,17),T(this,_,g(this,p).canvas.toDataURL()),{fingerprint:await r(g(this,_)),info:{image:g(this,_)}})}}p=new WeakMap,_=new WeakMap;function L(t){return t.reduce((e,a)=>e+(a?1:0),0)}function Y(){const t=window,e=navigator;return L(["ApplePayError"in t,"CSSPrimitiveValue"in t,"Counter"in t,e.vendor.indexOf("Apple")===0,"RGBColor"in t,"WebKitMediaKeys"in t])>=4}function ee(){var e;const t=window;return L(["buildID"in navigator,"MozAppearance"in(((e=document.documentElement)==null?void 0:e.style)??{}),"onmozfullscreenchange"in t,"mozInnerScreenX"in t,"CSSMozDocumentRule"in t,"CanvasCaptureMediaStream"in t])>=4}function te(){const t=window,e=navigator;return L(["webkitPersistentStorage"in e,"webkitTemporaryStorage"in e,e.vendor.indexOf("Google")===0,"webkitResolveLocalFileSystemURL"in t,"BatteryManager"in t,"webkitMediaStream"in t,"webkitSpeechGrammar"in t])>=5}const k=-1,W=-2,ne=new Set([10752,2849,2884,2885,2886,2928,2929,2930,2931,2932,2960,2961,2962,2963,2964,2965,2966,2967,2968,2978,3024,3042,3088,3089,3106,3107,32773,32777,32777,32823,32824,32936,32937,32938,32939,32968,32969,32970,32971,3317,33170,3333,3379,3386,33901,33902,34016,34024,34076,3408,3410,3411,3412,3413,3414,3415,34467,34816,34817,34818,34819,34877,34921,34930,35660,35661,35724,35738,35739,36003,36004,36005,36347,36348,36349,37440,37441,37443,7936,7937,7938]),oe=new Set([34047,35723,36063,34852,34853,34854,34229,36392,36795,38449]),re=["FRAGMENT_SHADER","VERTEX_SHADER"],ie=["LOW_FLOAT","MEDIUM_FLOAT","HIGH_FLOAT","LOW_INT","MEDIUM_INT","HIGH_INT"],B="WEBGL_debug_renderer_info",se="WEBGL_polygon_mode";function V({cache:t}){var o,h,c,w,m,S;const e=j(t);if(!e)return k;if(!z(e))return W;const a=K()?null:e.getExtension(B);return{version:((o=e.getParameter(e.VERSION))==null?void 0:o.toString())||"",vendor:((h=e.getParameter(e.VENDOR))==null?void 0:h.toString())||"",vendorUnmasked:a?(c=e.getParameter(a.UNMASKED_VENDOR_WEBGL))==null?void 0:c.toString():"",renderer:((w=e.getParameter(e.RENDERER))==null?void 0:w.toString())||"",rendererUnmasked:a?(m=e.getParameter(a.UNMASKED_RENDERER_WEBGL))==null?void 0:m.toString():"",shadingLanguageVersion:((S=e.getParameter(e.SHADING_LANGUAGE_VERSION))==null?void 0:S.toString())||""}}function H({cache:t}){const e=j(t);if(!e)return k;if(!z(e))return W;const a=e.getSupportedExtensions(),o=e.getContextAttributes(),h=[],c=[],w=[],m=[],S=[];if(o)for(const i of Object.keys(o))c.push(`${i}=${o[i]}`);const u=J(e);for(const i of u){const f=e[i];w.push(`${i}=${f}${ne.has(f)?`=${e.getParameter(f)}`:""}`)}if(a)for(const i of a){if(i===B&&K()||i===se&&ue())continue;const f=e.getExtension(i);if(!f){h.push(i);continue}for(const b of J(f)){const y=f[b];m.push(`${b}=${y}${oe.has(y)?`=${e.getParameter(y)}`:""}`)}}for(const i of re)for(const f of ie){const b=ae(e,i,f);S.push(`${i}.${f}=${b.join(",")}`)}return m.sort(),w.sort(),{contextAttributes:c,parameters:w,shaderPrecisions:S,extensions:a,extensionParameters:m,unsupportedExtensions:h}}function j(t){if(t.webgl)return t.webgl.context;const e=document.createElement("canvas");let a;e.addEventListener("webglCreateContextError",()=>a=void 0);for(const o of["webgl","experimental-webgl"]){try{a=e.getContext(o)}catch{}if(a)break}return t.webgl={context:a},a}function ae(t,e,a){const o=t.getShaderPrecisionFormat(t[e],t[a]);return o?[o.rangeMin,o.rangeMax,o.precision]:[]}function J(t){return Object.keys(t.__proto__).filter(ce)}function ce(t){return typeof t=="string"&&!t.match(/[^A-Z0-9_x]/)}function K(){return ee()}function ue(){return te()||Y()}function z(t){return typeof t.getParameter=="function"}class le{constructor(){A(this,"name","Canvas Feature");A(this,"enabled",!0);E(this,O,null)}async support(){return!0}async data(){return T(this,O,JSON.stringify(V({cache:{}}))+JSON.stringify(H({cache:{}}))),{fingerprint:g(this,O),info:{webgl:{basics:V({cache:{}}),extensions:H({cache:{}})}}}}}O=new WeakMap;const fe=async t=>t.enabled?await t.support()?await t.data():(console.log(`Feature ${t.name} is not supported`),null):(console.log(`Feature ${t.name} is disabled`),null),ge=async()=>await de(),de=async()=>{var c,w,m,S,u,i,f,b,y;const t=[new P,new d,new le];let e="",a="",o={basics:{},extensions:{}};const h=[];for(const C of t){const n=await fe(C);console.log(C.name,n==null?void 0:n.fingerprint),console.log((c=n==null?void 0:n.info)==null?void 0:c.image),console.log((w=n==null?void 0:n.info)==null?void 0:w.audio),console.log((m=n==null?void 0:n.info)==null?void 0:m.webgl),(S=n==null?void 0:n.info)!=null&&S.image&&(e=(u=n==null?void 0:n.info)==null?void 0:u.image),(i=n==null?void 0:n.info)!=null&&i.audio&&(a=(f=n==null?void 0:n.info)==null?void 0:f.audio),(b=n==null?void 0:n.info)!=null&&b.webgl&&(o=(y=n==null?void 0:n.info)==null?void 0:y.webgl),h.push((n==null?void 0:n.fingerprint)||"")}return console.log("JSON.stringify(webgl)",JSON.stringify(o)),{id:await r(JSON.stringify(h)),useragent:navigator.userAgent,rawData:{canvas:{hash:await r(e),"text image":e},audio:{hash:await r(a),value:a},webgl:{hash:await r(JSON.stringify(o)),value:o}}}};s.fpPromise=ge,Object.defineProperty(s,Symbol.toStringTag,{value:"Module"})});
