(function(i,t){typeof exports=="object"&&typeof module<"u"?t(exports):typeof define=="function"&&define.amd?define(["exports"],t):(i=typeof globalThis<"u"?globalThis:i||self,t(i.CRMFingerprint={}))})(this,function(i){"use strict";var X=Object.defineProperty;var N=i=>{throw TypeError(i)};var ee=(i,t,c)=>t in i?X(i,t,{enumerable:!0,configurable:!0,writable:!0,value:c}):i[t]=c;var b=(i,t,c)=>ee(i,typeof t!="symbol"?t+"":t,c),M=(i,t,c)=>t.has(i)||N("Cannot "+c);var l=(i,t,c)=>(M(i,t,"read from private field"),c?c.call(i):t.get(i)),y=(i,t,c)=>t.has(i)?N("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,c),S=(i,t,c,E)=>(M(i,t,"write to private field"),E?E.call(i,c):t.set(i,c),c),P=(i,t,c)=>(M(i,t,"access private method"),c);var v,D,R,C,Y,k,h,T,z;function t(u){function n(a,f){return a>>>f|a<<32-f}const m=new TextEncoder().encode(u),s=Array.from(m),g=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],r=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],A=s.length*8;for(s.push(128);(s.length*8+64)%512!==0;)s.push(0);const F=new Array(8).fill(0);for(let a=0;a<8;a++)F[7-a]=A>>>a*8&255;s.push(...F);const O=[];for(let a=0;a<s.length;a+=64)O.push(s.slice(a,a+64));return O.forEach(a=>{const f=new Array(64);for(let o=0;o<16;o++)f[o]=a[o*4]<<24|a[o*4+1]<<16|a[o*4+2]<<8|a[o*4+3];for(let o=16;o<64;o++){const I=n(f[o-15],7)^n(f[o-15],18)^f[o-15]>>>3,L=n(f[o-2],17)^n(f[o-2],19)^f[o-2]>>>10;f[o]=f[o-16]+I+f[o-7]+L|0}let[p,d,w,x,e,U,j,B]=r;for(let o=0;o<64;o++){const I=n(e,6)^n(e,11)^n(e,25),L=e&U^~e&j,H=B+I+L+g[o]+f[o]|0,_=n(p,2)^n(p,13)^n(p,22),Q=p&d^p&w^d&w,W=_+Q|0;B=j,j=U,U=e,e=x+H|0,x=w,w=d,d=p,p=H+W|0}r[0]=r[0]+p|0,r[1]=r[1]+d|0,r[2]=r[2]+w|0,r[3]=r[3]+x|0,r[4]=r[4]+e|0,r[5]=r[5]+U|0,r[6]=r[6]+j|0,r[7]=r[7]+B|0}),r.map(a=>(a>>>0).toString(16).padStart(8,"0")).join("")}class c{constructor(){y(this,C);b(this,"name","Audio Feature");b(this,"enabled",!0);y(this,v,null);y(this,D,null);y(this,R,5e3)}async support(){const n=window.OfflineAudioContext||window.webkitOfflineAudioContext;return n?(S(this,v,new n(1,l(this,R),44100)),l(this,v)!==null):!1}async data(){if(l(this,v)===null)return null;const n=await P(this,C,Y).call(this,l(this,v));return n===null?null:(S(this,D,await t(n.toString())),{fingerprint:l(this,D),info:{audio:n}})}}v=new WeakMap,D=new WeakMap,R=new WeakMap,C=new WeakSet,Y=function(n){return new Promise(m=>{const s=n.createOscillator();s.type="triangle",s.frequency.value=1e4;const g=n.createDynamicsCompressor();g.threshold.value=-50,g.knee.value=40,g.ratio.value=12,g.attack.value=0,g.release.value=.2,s.connect(g),g.connect(n.destination),s.start(),n.oncomplete=r=>{const A=r.renderedBuffer.getChannelData(0),F=P(this,C,k).call(this,A);m(F)},n.startRendering()})},k=function(n){let m=0;for(let s=0;s<n.length;++s)m+=Math.abs(n[s]);return m};class E{constructor(){b(this,"name","Canvas Feature");b(this,"enabled",!0);y(this,h,null);y(this,T,null)}async support(){return document?(S(this,h,document.createElement("canvas").getContext("2d")),l(this,h)!==null):!1}async data(){return l(this,h)===null?null:(l(this,h).textBaseline="top",l(this,h).font="14px 'Arial'",l(this,h).textBaseline="alphabetic",l(this,h).fillStyle="#f60",l(this,h).fillRect(100,1,55,20),l(this,h).fillStyle="#069",l(this,h).fillText("Cyber Universe Canvas",2,15),l(this,h).fillStyle="rgba(102, 204, 0, 0.7)",l(this,h).fillText("Cyber Universe Canvas",4,17),S(this,T,l(this,h).canvas.toDataURL()),{fingerprint:await t(l(this,T)),info:{image:l(this,T)}})}}h=new WeakMap,T=new WeakMap;function $(u){return parseFloat(u)}function V(){var m;const u=(m=window.Intl)==null?void 0:m.DateTimeFormat;if(u){const s=new u().resolvedOptions().timeZone;if(s)return s}const n=-q();return`UTC${n>=0?"+":""}${n}`}function q(){const u=new Date().getFullYear();return Math.max($(new Date(u,0,1).getTimezoneOffset()),$(new Date(u,6,1).getTimezoneOffset()))}class G{constructor(){b(this,"name","Canvas Feature");b(this,"enabled",!0);y(this,z,null)}async support(){return!0}async data(){return console.log("getTimezone",V()),S(this,z,V()),{fingerprint:await t(l(this,z)),info:{timezone:l(this,z)}}}}z=new WeakMap;const J=async u=>u.enabled?await u.support()?await u.data():(console.log(`Feature ${u.name} is not supported`),null):(console.log(`Feature ${u.name} is disabled`),null),K=async()=>await Z(),Z=async()=>{var r,A,F,O,a,f,p,d,w;const u=[new E,new c,new G];let n="",m="",s="";const g=[];for(const x of u){const e=await J(x);console.log(x.name,e==null?void 0:e.fingerprint),console.log((r=e==null?void 0:e.info)==null?void 0:r.image),console.log((A=e==null?void 0:e.info)==null?void 0:A.audio),console.log((F=e==null?void 0:e.info)==null?void 0:F.timezone),(O=e==null?void 0:e.info)!=null&&O.image&&(n=(a=e==null?void 0:e.info)==null?void 0:a.image),(f=e==null?void 0:e.info)!=null&&f.audio&&(m=(p=e==null?void 0:e.info)==null?void 0:p.audio),(d=e==null?void 0:e.info)!=null&&d.timezone&&(s=(w=e==null?void 0:e.info)==null?void 0:w.timezone),g.push((e==null?void 0:e.fingerprint)||"")}return{id:await t(JSON.stringify(g)),useragent:navigator.userAgent,rawData:{canvas:{hash:await t(n),"text image":n},audio:{hash:await t(m),value:m},timezone:{hash:await t(s),value:s}}}};i.fpPromise=K,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
