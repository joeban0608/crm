(function(n,t){typeof exports=="object"&&typeof module<"u"?t(exports):typeof define=="function"&&define.amd?define(["exports"],t):(n=typeof globalThis<"u"?globalThis:n||self,t(n.CRMFingerprint={}))})(this,function(n){"use strict";var z=Object.defineProperty;var H=n=>{throw TypeError(n)};var Q=(n,t,l)=>t in n?z(n,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):n[t]=l;var O=(n,t,l)=>Q(n,typeof t!="symbol"?t+"":t,l),I=(n,t,l)=>t.has(n)||H("Cannot "+l);var a=(n,t,l)=>(I(n,t,"read from private field"),l?l.call(n):t.get(n)),y=(n,t,l)=>t.has(n)?H("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,l),T=(n,t,l,D)=>(I(n,t,"write to private field"),D?D.call(n,l):t.set(n,l),l),M=(n,t,l)=>(I(n,t,"access private method"),l);var m,C,E,v,N,$,f,b;function t(h){function i(r,c){return r>>>c|r<<32-c}const d=new TextEncoder().encode(h),u=Array.from(d),p=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],A=u.length*8;for(u.push(128);(u.length*8+64)%512!==0;)u.push(0);const w=new Array(8).fill(0);for(let r=0;r<8;r++)w[7-r]=A>>>r*8&255;u.push(...w);const x=[];for(let r=0;r<u.length;r+=64)x.push(u.slice(r,r+64));return x.forEach(r=>{const c=new Array(64);for(let s=0;s<16;s++)c[s]=r[s*4]<<24|r[s*4+1]<<16|r[s*4+2]<<8|r[s*4+3];for(let s=16;s<64;s++){const P=i(c[s-15],7)^i(c[s-15],18)^c[s-15]>>>3,U=i(c[s-2],17)^i(c[s-2],19)^c[s-2]>>>10;c[s]=c[s-16]+P+c[s-7]+U|0}let[e,F,S,B,g,R,j,L]=o;for(let s=0;s<64;s++){const P=i(g,6)^i(g,11)^i(g,25),U=g&R^~g&j,V=L+P+U+p[s]+c[s]|0,J=i(e,2)^i(e,13)^i(e,22),K=e&F^e&S^F&S,_=J+K|0;L=j,j=R,R=g,g=B+V|0,B=S,S=F,F=e,e=V+_|0}o[0]=o[0]+e|0,o[1]=o[1]+F|0,o[2]=o[2]+S|0,o[3]=o[3]+B|0,o[4]=o[4]+g|0,o[5]=o[5]+R|0,o[6]=o[6]+j|0,o[7]=o[7]+L|0}),o.map(r=>(r>>>0).toString(16).padStart(8,"0")).join("")}class l{constructor(){y(this,v);O(this,"name","Audio Feature");O(this,"enabled",!0);y(this,m,null);y(this,C,null);y(this,E,5e3)}async support(){const i=window.OfflineAudioContext||window.webkitOfflineAudioContext;return i?(T(this,m,new i(1,a(this,E),44100)),a(this,m)!==null):!1}async data(){if(a(this,m)===null)return null;const i=await M(this,v,N).call(this,a(this,m));return i===null?null:(T(this,C,await t(i.toString())),{fingerprint:a(this,C),info:{audio:i}})}}m=new WeakMap,C=new WeakMap,E=new WeakMap,v=new WeakSet,N=function(i){return new Promise(d=>{const u=i.createOscillator();u.type="triangle",u.frequency.value=1e4;const p=i.createDynamicsCompressor();p.threshold.value=-50,p.knee.value=40,p.ratio.value=12,p.attack.value=0,p.release.value=.2,u.connect(p),p.connect(i.destination),u.start(),i.oncomplete=o=>{const A=o.renderedBuffer.getChannelData(0),w=M(this,v,$).call(this,A);d(w)},i.startRendering()})},$=function(i){let d=0;for(let u=0;u<i.length;++u)d+=Math.abs(i[u]);return d};class D{constructor(){O(this,"name","Canvas Feature");O(this,"enabled",!0);y(this,f,null);y(this,b,null)}async support(){return document?(T(this,f,document.createElement("canvas").getContext("2d")),a(this,f)!==null):!1}async data(){return a(this,f)===null?null:(a(this,f).textBaseline="top",a(this,f).font="14px 'Arial'",a(this,f).textBaseline="alphabetic",a(this,f).fillStyle="#f60",a(this,f).fillRect(100,1,55,20),a(this,f).fillStyle="#069",a(this,f).fillText("Cyber Universe Canvas",2,15),a(this,f).fillStyle="rgba(102, 204, 0, 0.7)",a(this,f).fillText("Cyber Universe Canvas",4,17),T(this,b,a(this,f).canvas.toDataURL()),{fingerprint:await t(a(this,b)),info:{image:a(this,b)}})}}f=new WeakMap,b=new WeakMap;const k=async h=>h.enabled?await h.support()?await h.data():(console.log(`Feature ${h.name} is not supported`),null):(console.log(`Feature ${h.name} is disabled`),null),q=async()=>await G(),G=async()=>{var p,o,A,w,x,r;const h=[new D,new l];let i="",d="";const u=[];for(const c of h){const e=await k(c);console.log(c.name,e==null?void 0:e.fingerprint),console.log((p=e==null?void 0:e.info)==null?void 0:p.image),console.log((o=e==null?void 0:e.info)==null?void 0:o.audio),(A=e==null?void 0:e.info)!=null&&A.image&&(i=(w=e==null?void 0:e.info)==null?void 0:w.image),(x=e==null?void 0:e.info)!=null&&x.audio&&(d=(r=e==null?void 0:e.info)==null?void 0:r.audio),u.push((e==null?void 0:e.fingerprint)||"")}return{id:await t(JSON.stringify(u)),useragent:navigator.userAgent,rawData:{canvas:{hash:await t(i),"text image":i},audio:{hash:await t(d),value:d}}}};n.fpPromise=q,Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})});
